{% extends "base.html" %}

{% block content %}
<section>
    <h1>Warenkorb</h1>

    {% if not items %}
        <p>Dein Warenkorb ist aktuell leer.</p>
        <p>Gehe zu den Abo-Modellen und stelle ein Abo für einen deiner Hunde zusammen.</p>
        <p>
            <a class="btn-primary" href="{{ url_for('plans_all') }}">Zu den Abo-Modellen</a>
        </p>
    {% else %}
        <div class="product-grid">
            {% for it in items %}
                <div class="product-card">
                    <div class="product-category">Abo für {{ it.dog_name }}</div>
                    <h2 class="product-name">{{ it.plan_title }}</h2>

                    <p class="product-desc"><strong>Produkt:</strong> {{ it.product_name }}</p>

                    <p><strong>Größe:</strong> {{ it.days }} Tage</p>

                    <p><strong>Menge:</strong> {{ it.amount_g }} g</p>
                    <p><strong>Preis:</strong> {{ "%.2f"|format(it.price) }} €</p>

                    <p>
                        <strong>Lieferintervall:</strong>
                        {% if it.delivery_interval_days %}
                            alle {{ it.delivery_interval_days }} Tage
                        {% else %}
                            noch nicht festgelegt
                        {% endif %}
                    </p>

                    <div style="display:flex; gap:0.75rem; margin-top:0.75rem; flex-wrap:wrap;">
                        <a class="btn-primary" href="{{ url_for('delivery_interval', item_index=loop.index0) }}"> <!--Loop index passt zu item.index-->
                            Lieferintervall einstellen
                        </a>

                        <form method="post" action="{{ url_for('cart_remove', item_index=loop.index0) }}">
                            <button type="submit" class="btn-secondary">Entfernen</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>

        <p style="margin-top:1rem;">
            <a class="btn-primary" href="{{ url_for('checkout') }}">Abos bestätigen</a>
        </p>
    {% endif %}
</section>
{% endblock %}
